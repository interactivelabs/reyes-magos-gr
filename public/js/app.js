document.addEventListener("alpine:init",()=>{Alpine.data("toasts",()=>({notifications:[],displayDuration:5e3,addNotification(e){let t=Date.now();this.notifications.length>=20&&this.notifications.splice(0,this.notifications.length-19),this.notifications.push({...e,id:t})},removeNotification(e){setTimeout(()=>{this.notifications=this.notifications.filter(t=>t.id!==e)},400)}}))});function c(e){window.dispatchEvent(new CustomEvent("notify",{detail:e}))}var h=e=>e&&e.includes("message")&&e.includes("Key"),y=e=>{let t=[],o=e.split(",").filter(n=>n.includes("Key")).map(n=>n.trim().replace("message=",""));for(let n of o){let a=n.split("\\n");for(let i=0;i<a.length;i++){let r=a[i],l=r.match(/Key: '([^']+)'/),s=r.match(/Error:(.+)/);l&&s&&t.push({key:l[1],message:s[1].trim()})}}return t};window.addEventListener("htmx:responseError",e=>{let t=e.detail.xhr.status;if(t===500&&c({variant:"error",title:"Error del servidor",message:"Ha ocurrido un error inesperado. Por favor intenta de nuevo."}),t===400){let{responseText:o}=e.detail.xhr;if(h(o)){let n=y(o),{target:a}=e;if(a instanceof HTMLFormElement){let i=a;for(let r of n){let l=r.key.split(".").pop(),s=i.querySelector(`[name="${l}"]`);s&&(s.setCustomValidity(r.message),s.reportValidity())}}}}});var d=async e=>{try{await navigator.clipboard.writeText(e),c({variant:"error",title:"Copiado!",message:"El codigo ha sido copiado al portapapeles."})}catch(t){console.error("Failed to copy: ",t)}},v=async e=>{let t={title:"Comparte la alegria!",text:`Utiliza este codigo para obtener un regalo: ${e}`,url:`${window.location.origin}/catalog?code=${e}`};try{await navigator.share(t)}catch(o){console.error("Share failed: ",o)}};globalThis.copyCode=d;globalThis.shareCode=async e=>{typeof navigator.share>"u"?d(e):v(e)};function E(e,t){let o;return function(...n){o&&clearTimeout(o),o=setTimeout(()=>{e.apply(this,n)},t)}}var m=E;var p=()=>document.getElementsByName("category[]"),g=e=>{e.delete("page");let t=e.toString();window.location.replace(`${window.location.pathname}?${t}`)},T=()=>{let e=document.getElementsByName("age_min")[0],t=document.getElementsByName("age_max")[0];return{ageMin:e.value,ageMax:t.value}},u=()=>{let e=p(),o=Array.from(e).filter(r=>r.checked).map(r=>r.value),n=new URLSearchParams(window.location.search);if(n.delete("category"),n.delete("age_min"),n.delete("age_max"),o.length>0)for(let r of o)n.append("category",r);let{ageMin:a,ageMax:i}=T();parseInt(a,10)>1&&n.set("age_min",a),parseInt(i,10)>1&&n.set("age_max",i),g(n)},w=()=>{let e=p();for(let o of e)o.checked=!1;let t=new URLSearchParams(window.location.search);t.delete("category"),t.delete("age_min"),t.delete("age_max"),g(t)},x=e=>{let t=p();if(e==="age_min"){let o=document.getElementsByName("age_min")[0];o.value="0"}else if(e==="age_max"){let o=document.getElementsByName("age_max")[0];o.value="0"}for(let o of t)o.value===e&&(o.checked=!1);u()},b=()=>{let e=new URLSearchParams(window.location.search),t=p();if(e.has("category")){let o=e.getAll("category");for(let n of t)o.includes(n.value)&&(n.checked=!0)}};globalThis.updateFilters=u;globalThis.clearFilters=w;globalThis.removeFilter=x;b();var M=()=>{document.body.scrollTop>300||document.documentElement.scrollTop>300?window.dispatchEvent(new CustomEvent("showbacktotopbtn")):window.dispatchEvent(new CustomEvent("hidebacktotopbtn"))},A=m(M,250);window.addEventListener("scroll",A);if(typeof gsap<"u"){gsap.registerPlugin(ScrollTrigger);for(let e=1;e<=3;e++)gsap.to(`#home-ilustracion-${e}`,{scrollTrigger:{trigger:`#home-ilustracion-${e}`,toggleActions:"play pause resume reset",start:"top 80%"},duration:1,opacity:1})}function f(){return document.getElementById("code").value.toUpperCase().trim().length>5}function H(e){f()||e.preventDefault()}document.addEventListener("alpine:init",()=>{Alpine.data("codeForm",()=>({valid:!0,init(){this.valid=!0},submit(e){this.valid=f(),e.preventDefault(),e.stopPropagation()},update(){let e=document.getElementById("code"),t=e.value.toUpperCase().trim();e.value=t,t.length>5&&(this.valid=!0)}}))});globalThis.beforeCheckoutHandler=H;
