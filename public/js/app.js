var m=({element:t,elementButton:e,event:s,onClose:n})=>{!(t.contains(s.target)||t===s.target||e.contains(s.target)||e===s.target)&&t.getAttribute("data-transition-state")==="open"&&(t.setAttribute("data-transition-state","closed"),n&&n())},u=t=>{t&&(t.getAttribute("data-transition-state")==="closed"?(t.setAttribute("open","true"),t.setAttribute("data-transition-state","open")):(t.removeAttribute("open"),t.setAttribute("data-transition-state","closed")))};function f(){let t=document.getElementById("admin-menu-dropdown"),e=document.getElementById("admin-menu-button"),s=n=>{n.stopPropagation(),u(t)};e?.addEventListener("click",s),document.addEventListener("click",n=>{n.stopPropagation(),t&&e&&m({element:t,elementButton:e,event:n})})}function E(){let t=document.getElementById("mobile-menu-container"),e=document.getElementById("mobile-menu-button"),s=document.getElementById("mobile-menu-button-icon-closed"),n=document.getElementById("mobile-menu-button-icon-open"),i=()=>{s?.classList.toggle("hidden"),n?.classList.toggle("hidden")},a=o=>{o.stopPropagation(),u(t),i()};e?.addEventListener("click",a),document.addEventListener("click",o=>{o.stopPropagation(),t&&e&&m({event:o,element:t,elementButton:e,onClose:i})})}var h=(t="")=>{let e=t?`${t}-`:"",s=document.getElementById(`toast-${e}container`),n=document.getElementById(`toast-${e}panel`);n?.classList.remove("show-toast"),n?.classList.add("hide-toast"),setTimeout(()=>{s?.classList.remove("flex"),s?.classList.add("hidden")},300)},g=({title:t,subTitle:e,duration:s=5e3,variant:n=""})=>{let i=n?`${n}-`:"",a=document.getElementById(`toast-${i}container`),o=document.getElementById(`toast-${i}panel`);a?.classList.remove("hidden"),a?.classList.add("flex"),o?.classList.remove("hide-toast"),o?.classList.add("show-toast");let r=document.getElementById(`toast-${i}title`),d=document.getElementById(`toast-${i}subtitle`);r.innerText=t,d.innerText=e,setTimeout(()=>h(n),s)},T=t=>g({...t,variant:"error"}),H=()=>h("error");function b(){globalThis.showToast=g,globalThis.hideToast=h,globalThis.showErrorToast=T,globalThis.hideErrorToast=H}var C=async t=>{try{await navigator.clipboard.writeText(t),g({title:"Copiado!",subTitle:"El codigo ha sido copiado al portapapeles."})}catch(e){console.error("Failed to copy: ",e)}},$=async t=>{let e={title:"Comparte la alegria!",text:`Utiliza este codigo para obtener un juguete: ${t}`,url:`${window.location.origin}/catalog`};try{await navigator.share(e)}catch(s){console.error("Share failed: ",s)}};function y(){globalThis.copyCode=C,globalThis.shareCode=async t=>{typeof navigator.share>"u"?C(t):$(t)}}var R=(t,e)=>{let s=t.getAttribute(e);if(!s)throw new Error(`Missing ${e} attribute`);let n=s.split(" "),i=n.filter(o=>o.startsWith("final:"));return[n.filter(o=>!o.startsWith("final:")),i]},L=(t,e,s)=>{let[n,i]=R(t,e),a=(o,r)=>{setTimeout(()=>{t.classList.add(r)},o)};n.forEach(o=>{s==="add"?(t.classList.add(o),a(10,o)):t.classList.remove(o)}),i.forEach(o=>{let r=o.split("final:")[1],[d,c]=JSON.parse(r.replace(/'/g,'"'));s==="add"?a(d,c):t.classList.remove(c)})},M=(t,e)=>{L(t,e,"add")},I=(t,e)=>{L(t,e,"remove")},A=(t,e)=>{let s=t.getAttribute(e);if(!s)throw new Error(`Missing ${e} attribute`);let i=s.split(" ").filter(o=>o.startsWith("delay-")||o.startsWith("duration-"));if(!i||!i.length)return 150;let a=0;return i.forEach(o=>{let r=parseInt(o.split("-")[1],10);a+=r}),a};function w(){let t="data-transition-state",e=a=>{a.style.display="none"},s=a=>{a.style.display="block",a.offsetHeight},n=a=>{for(let o of a){let{type:r,attributeName:d,oldValue:c,target:l}=o;if(r!=="attributes"||d!==t||!l)return;let v=l.getAttribute(t);if(M(l,`data-transition-${v}`),v==="open")s(l);else{let F=A(l,`data-transition-${c}`);setTimeout(()=>e(l),F)}c&&I(l,`data-transition-${c}`)}},i=new MutationObserver(n);document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(`[${t}]`).forEach(o=>{let r=o.getAttribute(t);if(r!=="closed"&&r!=="open")throw new Error(`Invalid ${r} for transitions, use data-styles-[state] for non open/close transitions`);r==="closed"?e(o):s(o),M(o,`data-transition-${r}`),i.observe(o,{attributes:!0,attributeOldValue:!0,attributeFilter:[t]})})})}var p=()=>document.getElementsByName("category[]"),S=t=>{t.delete("page");let e=t.toString();window.location.replace(`${window.location.pathname}?${e}`)},k=()=>{let t=document.getElementsByName("age_min")[0],e=document.getElementsByName("age_max")[0];return{ageMin:t.value,ageMax:e.value}},B=()=>{let t=p(),s=Array.from(t).filter(o=>o.checked).map(o=>o.value),n=new URLSearchParams(window.location.search);if(n.delete("category"),n.delete("age_min"),n.delete("age_max"),s.length>0)for(let o of s)n.append("category",o);let{ageMin:i,ageMax:a}=k();parseInt(i,10)>1&&n.set("age_min",i),parseInt(a,10)>1&&n.set("age_max",a),S(n)},O=()=>{let t=p();for(let s of t)s.checked=!1;let e=new URLSearchParams(window.location.search);e.delete("category"),e.delete("age_min"),e.delete("age_max"),S(e)},D=t=>{let e=p();for(let s of e)s.value===t&&(s.checked=!1);B()},N=()=>{let t=new URLSearchParams(window.location.search),e=p();if(t.has("category")){let s=t.getAll("category");for(let n of e)s.includes(n.value)&&(n.checked=!0)}};function x(){globalThis.updateFilters=B,globalThis.clearFilters=O,globalThis.removeFilter=D,N()}window.addEventListener("htmx:responseError",t=>{console.log(t),t.detail.xhr.status===500&&T({title:"Error del servidor",subTitle:"Ha ocurrido un error inesperado. Por favor intenta de nuevo."})});w();y();f();E();b();x();
